{% assign img = include.img %}
{% if jekyll.environment == 'production' or jekyll.environment == 'gulp' %}
    {% assign src = img | split: 'src="' | last | split: '"' | first %}
    <picture>
        {% if include.bp_list %}
            {% assign bp_list = include.bp_list %}
        {% else %}
            {% assign bp_list = site.image_bp | reverse %}
        {% endif %}
        <!--[if IE 9]><video style="display: none;"><![endif]-->
        {% for bp in bp_list %}
            {% assign x = bp | map: 'x' %}
            {% assign y = bp | map: 'y' %}
            {% capture suffix %}-{{ x }}x{{ y }}{% endcapture %}
            <source media="(max-width: {{ x }}px) and (max-height: {{ y }}px)" srcset="{% include file-suffix.liquid file_name=src suffix=suffix %}">
        {% endfor %}
        <source srcset="{{ src }}">
        <!--[if IE 9]></video><![endif]-->
        {{ img | replace_first: 'src=', 'srcset=' }}
    </picture>
{% else %}
    {{ img }}
{% endif %}
